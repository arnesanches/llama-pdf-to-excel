#### English 

# Llama PDF to Excel

This project aims to extract tables from PDF files and convert them into Excel (.xlsx) files with proper formatting. The process is divided into two main stages, each executed by a Python script.

## Project Structure

The project consists of the following elements:

- **1_pdf_to_md.py**: Script responsible for extracting tables from a PDF file and saving them in Markdown (.md) format.
- **2_md_to_excel.py**: Script that converts the generated Markdown files into Excel (.xlsx) files.
- **resultado.pdf**: Input PDF file containing the tables to be extracted.
- **my_pdf Folder**: Folder where the Markdown files generated by the first script will be stored.
- **tabelas Folder**: Folder where the resulting Excel files will be saved.

## How to Use

### Step 1: Preparation

Before running the scripts, follow these steps:

1. Manually create the **my_pdf** and **tabelas** folders in the same directory where the scripts are located. These folders are needed to store intermediate files and final results.
2. Ensure the necessary dependencies are installed in your Python environment, such as **llama_parse**, **openpyxl**, and **pandas**. You can install these dependencies by running:
3. Make sure the PDF file to be processed is in the same directory as the scripts and named **resultado.pdf**.

### Step 2: Extract Tables

1. Run the **1_pdf_to_md.py** file. This script will:

- Extract tables from the PDF file.
- Save the extracted tables in Markdown (.md) format in the **my_pdf** folder.

After execution, .md files corresponding to the pages of the PDF will be generated and saved in the **my_pdf** folder.

### Step 3: Convert to Excel

2. Run the **2_md_to_excel.py** file. This script will:

- Process the .md files in the **my_pdf** folder.
- Extract the tables in Markdown format and convert them to Excel (.xlsx) files.
- Save the generated Excel files in the **tabelas** folder.

The execution of the second script depends on the .md files generated by the first, so make sure to follow this order.

## Dependencies

- **llama_parse**: For extracting tables from PDF files.
- **openpyxl**: For creating and manipulating Excel files.
- **pandas**: For processing and manipulating the extracted tables.

## Notes

- Ensure that the **my_pdf** and **tabelas** folders are correctly created before running the scripts.
- The input PDF file should be named **resultado.pdf** and be in the same directory as the scripts.
- The project was developed to work with PDF files containing well-structured tables. If the tables are not well-structured, the process may not work as expected.

## Contributions

Contributions to the project are welcome. If you have suggestions or encounter issues, feel free to open a pull request or report them in the issues section.

---

#### Português

# Llama PDF to Excel

Este projeto tem como objetivo extrair tabelas de arquivos PDF e convertê-las em arquivos Excel (.xlsx) com formatação adequada. O processo é dividido em duas etapas principais, cada uma executada por um script Python.

## Estrutura do Projeto

O projeto é composto pelos seguintes elementos:

- **1_pdf_to_md.py**: Script responsável por extrair tabelas de um arquivo PDF e salvá-las no formato Markdown (.md).
- **2_md_to_excel.py**: Script que converte os arquivos Markdown gerados em arquivos Excel (.xlsx).
- **resultado.pdf**: Arquivo PDF de entrada com as tabelas a serem extraídas.
- **Pasta my_pdf**: Pasta onde serão armazenados os arquivos Markdown gerados pelo primeiro script.
- **Pasta tabelas**: Pasta onde os arquivos Excel resultantes serão salvos.

## Como Usar

### Passo 1: Preparação

Antes de executar os scripts, siga os seguintes passos:

1. Crie manualmente as pastas **my_pdf** e **tabelas** no mesmo diretório onde os scripts estão localizados. Essas pastas são necessárias para armazenar os arquivos intermediários e os resultados finais.
2. Verifique se as dependências necessárias estão instaladas no seu ambiente Python, como **llama_parse**, **openpyxl** e **pandas**. Você pode instalar essas dependências utilizando o comando:
3. Certifique-se de que o arquivo PDF a ser processado está no mesmo diretório dos scripts e nomeado como **resultado.pdf**.

### Passo 2: Extração de Tabelas

1. Execute o arquivo **1_pdf_to_md.py**. Este script irá:

- Extrair as tabelas do arquivo PDF.
- Salvar as tabelas extraídas no formato Markdown (.md) na pasta **my_pdf**.

Após a execução, serão gerados arquivos .md correspondentes às páginas do PDF, que serão salvos na pasta **my_pdf**.

### Passo 3: Conversão para Excel

2. Execute o arquivo **2_md_to_excel.py**. Este script irá:

- Processar os arquivos .md da pasta **my_pdf**.
- Extrair as tabelas no formato Markdown e convertê-las para arquivos Excel (.xlsx).
- Salvar os arquivos Excel gerados na pasta **tabelas**.

A execução do segundo script depende dos arquivos .md gerados pelo primeiro, portanto, siga essa ordem.

## Dependências

- **llama_parse**: Para a extração de tabelas a partir de arquivos PDF.
- **openpyxl**: Para a criação e manipulação de arquivos Excel.
- **pandas**: Para o processamento e manipulação das tabelas extraídas.

## Observações

- Certifique-se de que as pastas **my_pdf** e **tabelas** estão corretamente criadas antes de executar os scripts.
- O arquivo PDF de entrada deve ser nomeado como **resultado.pdf** e estar no mesmo diretório dos scripts.
- O projeto foi desenvolvido para funcionar com arquivos PDF que contêm tabelas bem estruturadas. Caso contrário, o processo pode não funcionar como esperado.

## Contribuições

Contribuições para o projeto são bem-vindas. Se você tiver sugestões ou encontrar problemas, sinta-se à vontade para abrir um pull request ou relatar na seção de issues.
